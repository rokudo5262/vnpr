!function(l){"use strict";l.notificationxPro=l.notificationxPro||{},l(document).ready(function(){l.notificationxPro.init();var i=l("#nxpro-zapier-instructions");l("body").on("change",".nx_meta_display_type",function(){var e=l(this).val();i.hide(),"press_bar"!=e&&l.notificationxPro.soundChange(e),l(document.querySelectorAll(".nx-template-keys")).each(function(e,n){l(n).removeClass("nxtk-active")});var n=document.querySelector(".nx-template-keys."+e);l(n).addClass("nxtk-active");var t=l(".nx-builder-tab-menu").find('li[data-tab="content_tab"]');switch(0<t.length&&t.hide(),e){case"email_subscription":l(".nx-mailchimp_theme .nx_meta_mailchimp_theme:checked").trigger("change"),l("#nx_meta_mailchimp_advance_edit").trigger("change"),l.notificationx.trigger(".nx_meta_subscription_source");break;case"page_analytics":l(".nx-page_analytics_theme .nx_meta_page_analytics_theme:checked").trigger("change"),l("#nx_meta_page_analytics_advance_edit").trigger("change"),l.notificationx.trigger(".nx_meta_page_analytics_source");break;case"custom":l(".nx-custom_theme .nx_meta_custom_theme:checked").trigger("change"),l("#nx_meta_custom_advance_edit").trigger("change"),0<t.length&&t.css("display","inline-block")}}),l(".nx_meta_page_analytics_theme").on("change",function(e){"pa-theme-two"!=e.currentTarget.value||l("#nx_meta_show_default_image").is(":checked")||l("#nx_meta_show_default_image").trigger("click"),"pa-theme-two"==e.currentTarget.value&&l("input#flames_svg_nx_meta_default_avatar").parents(".nx-single-theme-wrapper").find("label").trigger("click"),"pa-theme-one"==e.currentTarget.value&&l("#nx_meta_show_default_image").is(":checked")&&l("#nx_meta_show_default_image").val("0").trigger("click"),"pa-theme-three"!=e.currentTarget.value||l("#nx_meta_show_default_image").is(":checked")||l("#nx_meta_show_default_image").trigger("click"),"pa-theme-three"==e.currentTarget.value&&l("input#verified_svg_nx_meta_default_avatar").parents(".nx-single-theme-wrapper").find("label").trigger("click")}),l("body").on("change",".nx_meta_conversion_from",function(){var e=l(this).val();switch(i.hide(),e){case"woocommerce":l("#nx_meta_product_control").trigger("change"),l("#nx_meta_product_exclude_by").trigger("change");break;case"edd":l("#nx_meta_edd_product_control").trigger("change"),l("#nx_meta_edd_product_exclude_by").trigger("change");break;case"custom_notification":l("#nx_meta_custom_template_adv").trigger("change");break;case"zapier":i.fadeIn(200);break;case"freemius":l("#nx_meta_freemius_item_type").trigger("change"),l("#nx_meta_woo_template_adv").trigger("change")}}),l("body").on("change",".nx_meta_elearning_source",function(){switch(l(this).val()){case"learndash":l("#nx_meta_ld_product_control").trigger("change")}}),l("body").on("change",".nx_meta_reviews_source",function(){var e=l(this).val();switch(i.hide(),e){case"freemius":l("#nx_meta_freemius_item_type").trigger("change");break;case"zapier":i.fadeIn(200)}}),l("body").on("change",".nx_meta_stats_source",function(){switch(l(this).val()){case"freemius":l("#nx_meta_freemius_item_type").trigger("change")}}),l("body").on("change",".nx_meta_page_analytics_source",function(){var e=l(this).val();l.notificationx.get_instructions_enabled(!1,e)}),l("body").on("change",".nx_meta_subscription_source",function(){var e=l(this).val();switch(l.notificationx.get_instructions_enabled(!1,e),l(".nx-mailchimp_theme .nx_meta_mailchimp_theme:checked").trigger("change"),i.hide(),e){case"mailchimp":l("#nx_meta_mailchimp_template_adv").trigger("change")}"zapier"===e&&i.fadeIn(200)}),l("body").on("change",".nx_meta_theme, .nx_meta_comment_theme, .nx_meta_mailchimp_theme, .nx_meta_elearning_theme, .nx_meta_donation_theme",function(e){var n=l(this).val();""==l("#nx_meta_show_notification_image").data("value")&&("maps_theme"==n||"conv-theme-six"==n?l("#nx_meta_show_notification_image").val("maps_image").trigger("change"):l("#nx_meta_show_notification_image").val("product_image").trigger("change"))}),l("body").on("change","#nx_sound_checkbox",function(){var e=l(".nx_meta_display_type:checked").val(),n=l("#nx_meta_"+e+"_sound");l(this).parents(".nx-sound-appearance").find(".nx-left .nx-sound-active").removeClass("nx-sound-active").siblings().addClass("nx-sound-active"),this.checked?(n.val("to-the-point").trigger("change"),l("body, html").animate({scrollTop:n.offset().top},500)):n.val("none").trigger("change")})}),l.notificationxPro.init=function(){l.notificationxPro.bindEvents(),l.notificationxPro.initializeFields(),l.notificationxPro.clipboard(),l.notificationxPro.disableGoogleAnalyticsOptions()},l.notificationxPro.soundChange=function(e){l("body").on("change","#nx_meta_"+e+"_sound",function(){var e,n=l(this).val(),t=l("#nx_meta_volume").val();"none"==n||0<(e=l(".nx-admin-audio-list").find("#"+n)).length&&((e=e[0]).volume=parseFloat(t),e.play())})},l.notificationxPro.clipboard=function(){var e=new ClipboardJS(".nx-shortcode-btn");l("#nx_meta_zapier_api_key").on("click",function(e){l(this).val()}),e.on("success",function(e){swal({title:"Copied",text:e.text,icon:"success",buttons:!1,timer:1e3}),e.clearSelection()})},l.notificationxPro.initializeFields=function(){0<l(".nx-slider-wrap").length&&l(".nx-slider-wrap").map(function(e,n){var o=l(n).find(".ui-slider-handle"),r=l(n).find("input"),t=r.attr("value"),i=parseInt(100*t);l(n).slider({create:function(){l(this).slider("value",i),o.text(i),r.val(t)},slide:function(e,n){var t,i,a=l(".nx_meta_display_type:checked").val(),c=l("#nx_meta_"+a+"_sound").val();"none"==c||0<(t=l(".nx-admin-audio-list").find("#"+c)).length&&((t=t[0]).volume=parseFloat(n.value/100),t.played&&t.load(),void 0!==(i=t.play())&&i.then(function(){}).catch(function(e){})),o.text(n.value),r.val(n.value/100)}})})},l.notificationxPro.disableGoogleAnalyticsOptions=function(){},l.notificationxPro.bindEvents=function(){l("#nx_meta_show_on").on("change",function(){var e=l(this).val();"everywhere"!=e&&l("#nx_meta_all_locations").trigger("change"),"everywhere"==e&&l("#nx_meta_all_locations").val("is_front_page").trigger("change")}),l("body #nx-api_integrations_tab").find("div.nx-api-integration-settings").length==l("body #nx-api_integrations_tab").find("div.nx-api-integration-settings.hidden").length?l(".nx-settings-menu").find('li[data-tab="api_integrations_tab"]').hide():l(".nx-settings-menu").find('li[data-tab="api_integrations_tab"]').css("display","inline-block"),l("body").on("click",".nx-api-integration-header",function(e){e.preventDefault(),l(this).parent(".nx-api-integration-settings").siblings().find(".nx-api-integration-inner.open").slideUp(),l(this).next(".nx-api-integration-inner").slideDown().addClass("open")}),l("body").on("click",".nx-checkbox input",function(e){e.stopPropagation();var n=l("#api_"+this.id),t=l("body #nx-api_integrations_tab").find("div.nx-api-integration-settings").length;0<n.length&&(this.checked?n.removeClass("hidden"):n.addClass("hidden"),t==l("body #nx-api_integrations_tab").find("div.nx-api-integration-settings.hidden").length?l(".nx-settings-menu").find('li[data-tab="api_integrations_tab"]').hide():l(".nx-settings-menu").find('li[data-tab="api_integrations_tab"]').css("display","inline-block"))}),l("body").delegate(".nx-api-settings-button.mailchimp_settings_section","click",function(e){e.preventDefault(),l.notificationxPro.mailchimpConnect(this)}),l("body").delegate(".nx-api-settings-button.freemius_settings_section","click",function(e){e.preventDefault(),l.notificationxPro.freemiusConnect(this)}),l("body").delegate(".nx-api-settings-button.convertkit_settings_section","click",function(e){e.preventDefault(),l.notificationxPro.convertkitConnect(this)}),l("body").delegate(".nx-api-settings-button.envato_settings_section","click",function(e){e.preventDefault(),l.notificationxPro.envatoAPI(this)}),l("body").on("click",".nx-api-settings-button.google_analytics_settings_section",function(e){e.preventDefault(),l.notificationxPro.googleApiConnect(this)}),l("body").on("click",".google_analytics_settings_section .disconnect-analytics",function(e){e.preventDefault(),l.notificationxPro.googleApiDisConnect(this)}),l("body").on("click",".google_analytics_settings_section .setup-google-app",function(e){e.preventDefault(),l.notificationxPro.setupUserGoogleAppOptions(this)}),l("body").on("click",".google_analytics_settings_section .connect-user-app",function(e){e.preventDefault(),l.notificationxPro.connectUserGoogleApp(this)})},l.notificationxPro.mailchimpConnect=function(e){var n=(e=l(e)).data("key"),t=e.parent().find("#nx_meta_mailchimp_api_key").val(),i={action:"nx_mailchimp_connect",nonce:e.data("nonce"),api_key:t,key:n};l.notificationxPro.AJAX(i,e)},l.notificationxPro.freemiusConnect=function(e){var n=(e=l(e)).data("key"),t=e.parent(),i=t.find("#nx_meta_freemius_dev_id").val(),a=t.find("#nx_meta_freemius_dev_pk").val(),c=t.find("#nx_meta_freemius_dev_sk").val(),o={action:"nx_freemius_connect",nonce:e.data("nonce"),dev_id:i,dev_public_key:a,dev_secret_key:c,key:n};l.notificationxPro.AJAX(o,e)},l.notificationxPro.convertkitConnect=function(e){var n=(e=l(e)).data("key"),t=e.parent(),i=t.find("#nx_meta_convertkit_api_key").val(),a=t.find("#nx_meta_convertkit_api_secret").val(),c={action:"nx_convertkit_connect",nonce:e.data("nonce"),api_key:i,api_secret:a,key:n};l.notificationxPro.AJAX(c,e)},l.notificationxPro.envatoAPI=function(e){var n=(e=l(e)).data("key"),t=e.parent().find("#nx_meta_envato_token").val(),i={action:"nx_envato_api",nonce:e.data("nonce"),api_token:t,key:n};l.notificationxPro.AJAX(i,e)},l.notificationxPro.googleApiConnect=function(e){var n=(e=l(e)).data("key"),t=e.parent(),i=t.find("#nx_meta_ga_profile").val(),a=t.find("#nx_meta_ga_cache_duration").val(),c={action:"nx_save_ga_settings",nonce:e.data("nonce"),ga_profile:i,ga_cache_duration:a,key:n};l.notificationxPro.AJAX(c,e)},l.notificationxPro.googleApiDisConnect=function(e){e=l(e);l.ajax({type:"POST",url:NXPROJS.ajaxurl,data:{action:"nx_ga_disconnect_account"},beforeSend:function(){e.html('<svg id="nx-spinner" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><circle cx="24" cy="4" r="4" fill="#fff"/><circle cx="12.19" cy="7.86" r="3.7" fill="#fffbf2"/><circle cx="5.02" cy="17.68" r="3.4" fill="#fef7e4"/><circle cx="5.02" cy="30.32" r="3.1" fill="#fef3d7"/><circle cx="12.19" cy="40.14" r="2.8" fill="#feefc9"/><circle cx="24" cy="44" r="2.5" fill="#feebbc"/><circle cx="35.81" cy="40.14" r="2.2" fill="#fde7af"/><circle cx="42.98" cy="30.32" r="1.9" fill="#fde3a1"/><circle cx="42.98" cy="17.68" r="1.6" fill="#fddf94"/><circle cx="35.81" cy="7.86" r="1.3" fill="#fcdb86"/></svg><span>Disconnecting...</span>')},success:function(e){"success"===JSON.parse(e).status&&window.location.reload()}})},l.notificationxPro.setupUserGoogleAppOptions=function(e){var n=l(e),t="Setting up environment...";l("#nx-meta-ga_profile").length&&(t="Disconnecting account..."),l.ajax({type:"POST",url:NXPROJS.ajaxurl,data:{action:"nx_ga_disconnect_account"},beforeSend:function(){n.html('<svg id="nx-spinner" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><circle cx="24" cy="4" r="4" fill="#fff"/><circle cx="12.19" cy="7.86" r="3.7" fill="#fffbf2"/><circle cx="5.02" cy="17.68" r="3.4" fill="#fef7e4"/><circle cx="5.02" cy="30.32" r="3.1" fill="#fef3d7"/><circle cx="12.19" cy="40.14" r="2.8" fill="#feefc9"/><circle cx="24" cy="44" r="2.5" fill="#feebbc"/><circle cx="35.81" cy="40.14" r="2.2" fill="#fde7af"/><circle cx="42.98" cy="30.32" r="1.9" fill="#fde3a1"/><circle cx="42.98" cy="17.68" r="1.6" fill="#fddf94"/><circle cx="35.81" cy="7.86" r="1.3" fill="#fcdb86"/></svg><span>'+t+"</span>")},success:function(e){"success"===JSON.parse(e).status&&(l("#nx-meta-ga_disconnect, #nx-meta-ga_profile, #nx-meta-ga_cache_duration, #nx-meta-ga_connect").hide().remove(),n.parents(".nx-field").hide(),l("#nx-meta-ga_redirect_uri, #nx-meta-ga_client_id, #nx-meta-ga_client_secret, #nx-meta-ga_user_app_connect").fadeIn())}})},l.notificationxPro.connectUserGoogleApp=function(e){var n=l(e),t=l("#nx_meta_ga_client_id").val(),i=l("#nx_meta_ga_client_secret").val();if(0===t.length||0===i.length)return 0===t.length&&l("#nx_meta_ga_client_id").addClass("has-error").after('<small class="nx-error">Client Id is required </small>'),void(0===t.length&&l("#nx_meta_ga_client_secret").addClass("has-error").after('<small class="nx-error">Client Secret is required </small>'));var a=l(".nx-settings-wrap .nx-settings #nx-settings-form"),c={action:"nx_ga_save_user_app_info",key:n.data("key"),nonce:n.data("nonce"),form_data:l(a).serializeArray(),client_id:t,client_secret:i};l.ajax({type:"POST",url:NXPROJS.ajaxurl,data:c,beforeSend:function(){n.html('<svg id="nx-spinner" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><circle cx="24" cy="4" r="4" fill="#fff"/><circle cx="12.19" cy="7.86" r="3.7" fill="#fffbf2"/><circle cx="5.02" cy="17.68" r="3.4" fill="#fef7e4"/><circle cx="5.02" cy="30.32" r="3.1" fill="#fef3d7"/><circle cx="12.19" cy="40.14" r="2.8" fill="#feefc9"/><circle cx="24" cy="44" r="2.5" fill="#feebbc"/><circle cx="35.81" cy="40.14" r="2.2" fill="#fde7af"/><circle cx="42.98" cy="30.32" r="1.9" fill="#fde3a1"/><circle cx="42.98" cy="17.68" r="1.6" fill="#fddf94"/><circle cx="35.81" cy="7.86" r="1.3" fill="#fcdb86"/></svg><span>Connecting...</span>')},success:function(e){var n=JSON.parse(e);"success"===n.status&&window.location.replace(n.auth_url)},complete:function(){n.html("disconnect")}})},l.notificationxPro.AJAX=function(e,t){var n,i,a;""!=e&&null!=e&&(n=l(".nx-settings-wrap .nx-settings #nx-settings-form"),i=l(n).serializeArray(),e.form_data=i,a=t.text(),l.ajax({type:"POST",url:NXPROJS.ajaxurl,data:e,beforeSend:function(){t.html('<svg id="nx-spinner" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><circle cx="24" cy="4" r="4" fill="#fff"/><circle cx="12.19" cy="7.86" r="3.7" fill="#fffbf2"/><circle cx="5.02" cy="17.68" r="3.4" fill="#fef7e4"/><circle cx="5.02" cy="30.32" r="3.1" fill="#fef3d7"/><circle cx="12.19" cy="40.14" r="2.8" fill="#feefc9"/><circle cx="24" cy="44" r="2.5" fill="#feebbc"/><circle cx="35.81" cy="40.14" r="2.2" fill="#fde7af"/><circle cx="42.98" cy="30.32" r="1.9" fill="#fde3a1"/><circle cx="42.98" cy="17.68" r="1.6" fill="#fddf94"/><circle cx="35.81" cy="7.86" r="1.3" fill="#fcdb86"/></svg><span>Connecting...</span>')},success:function(e){var n;t.html(a),""!=e&&("success"==(n=JSON.parse(e)).status?swal({title:"Settings Saved!",text:"Click OK to continue",icon:"success",buttons:[!1,"Ok"],timer:2e3}):swal({title:"Something went wrong!",text:n.message,icon:"error",buttons:[!1,"Cancel"]}))},complete:function(e){l(".nx-pro-mc-message");e.statusText}}))}}(jQuery);