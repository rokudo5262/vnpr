!function(w){"use strict";w.fn.zufusiontable=function(t){var z=w.extend({breakpoint:{xs:480,sm:576,md:992,lg:1200,xlg:1400},iconPlus:'<i class="fa fa-plus text-info"></i>',iconMinus:'<i class="fa fa-minus text-danger"></i>',allExpended:!1},t),e=this;function a(){var v=w(window).width();e.each(function(){var b=w(this),h=b.data("all-expanded");void 0===h&&(h=z.allExpended);var p=b.find("thead tr:first th[data-breakpoint]");if(p.length<=0)return!1;b.find("> tbody > tr").not(".zufusiontable-row").each(function(t){for(var e=w(this),a=(e.find("td"),e.data("formated")),o=e.data("expanded"),i='<table class="zufusiontable-subtable table table-bordered"><tbody>',n=0,s=0;s<p.length;s++){var l=p.eq(s),d=l.prop("cellIndex")+1,u=l.data("breakpoint"),r=e.find("td:nth-child("+d+")"),f=r.data("title");if(void 0!==f&&""!=f||(f=l.html()),r<=0)return console.log("TD Column "+d+" not found"),!1;"undefined"!==z.breakpoint[u]&&z.breakpoint[u]>=v?(i+='<tr class="zufusiontable-subrow"> <td class="zufusiontable-subcol" style="width:30%; background:#eee;">'+f+'</td> <td class="zufusiontable-subcol">'+r.html()+"</td> </tr>",l.hide(),r.hide(),n++):(l.show(),r.show())}if(i+="</tbody></table>",void 0===a&&0<n){e.data("formated",!0),e.after('<tr id="zufusiontable-row-'+t+'" class="zufusiontable-row"> <td colspan="100%" class="zufusiontable-col"> '+i+" </td> </tr>");var c=z.iconMinus;void 0!==o&&0!=o||void 0!==h&&0!=h||(w("#zufusiontable-row-"+t,b).hide(),c=z.iconPlus),w("#zufusiontable-row-"+t,b).prev().find("td:visible").first().prepend('<a href="javascript:void(0);" class="zufusiontable-collapse" data-opened="true">'+c+"</a>")}else a&&0<n?w("#zufusiontable-row-"+t+" > td",b).html(i):n<=0&&(e.removeData("formated"),w("#zufusiontable-row-"+t,b).remove(),w(".zufusiontable-collapse",b).remove())})})}w(window).resize(function(){a()}),a(),w("body").unbind().on("click",".zufusiontable-collapse",function(t){t.preventDefault();var e=w(this),a=e.closest("td").closest("tr").next();a.is(":visible")?(a.fadeOut("fast"),e.html(z.iconPlus)):(a.fadeIn(),e.html(z.iconMinus))})}}(jQuery);